#include "OnSend.h"
#include "Interface.h"
#include "Hooks.h"
#include "Tools.h"

CREATE_INTERFACE(IOnSend)

//2021 engine
unsigned long IOnSend::Patches[] = {
0x0041CD44,0x0041CE03,0x0042D164,0x0042D19C,0x0042D27A,0x0042D2AF,0x0042DBD4,
0x0042DC58,0x0042DD36,0x0042DDB9,0x0042DE3A,0x0042F4F5,0x0042F706,0x00430DA2,0x00431214,0x004314CB,0x00431755,
0x00431789,0x0043188C,0x004318B9,0x00431971,0x004319E5,0x00431DBE,0x00431E2B,0x0043201F,0x00432177,0x004321A2,
0x004321BB,0x004338F4,0x00433B3E,0x00433E2F,0x0045702E,0x00491C0C,0x004DC914,0x004DC957,0x00547B01,0x0054BA93,
0x0054BAB7,0x0054BADB,0x0054BAFF,0x0054BB23,0x0054BB47,0x0054BB6B,0x0054BB8F,0x0054BBB0,0x0054BBD1,0x0054BBF2,
0x0054CABD,0x0054CAE4,0x0054CB0B,0x0054CB32,0x0054CB59,0x0054CB80,0x0054CBA4,0x0054CBC8,0x0054CBEC,0x0054CC2A,
0x0054CC68,0x0054CD15,0x0054CD3C,0x0054CD63,0x0054CD8A,0x0054CDB1,0x0054CDD8,0x0054CDFC,0x0054CE20,0x0054CE44,
0x0054CE8D,0x0054CED3,0x0054E0FC,0x0054FAEF,0x0055013F,0x00554C98,0x0055545A,0x005554A3,0x00555909,0x005559F7,
0x00555A40,0x00555EA3,0x0055638F,0x0055703B,0x0055720B,0x0055724D,0x00557494,0x00557632,0x00558188,0x005598F6,
0x00559C6E,0x00559DA1,0x0055A08F,0x0055A7F5,0x0055B5EF,0x0055B632,0x0055B675,0x0055B6B3,0x0055B738,0x0055B8B4,
0x0055BB2C,0x0055BBEB,0x0055BC2D,0x0055C93B,0x0055C9B7,0x0055CA29,0x0055ED73,0x0055EDB3,0x00560791,0x00563098,
0x00563B8F,0x00564224,0x00564459,0x0056530B,0x005663BB,0x005671E5,0x005672A3,0x0056A222,0x0056A32A,0x0056A384,
0x0056CD92,0x0056EC37,0x0056EC99,0x0056ECF8,0x00572115,0x0057229B,0x0057D7FE,0x0057DDD4,0x00581F43,0x00581F87,
0x0058BCB2,0x0058D2B7,0x0058D604,0x00592EE0,0x00593AEE,0x00593D0A,0x00593E14,0x00593FE0,0x00596BC0,0x00596BF3,
0x00598DEB,0x00599675,0x00599CA0,0x00599FBD,0x0059A9DD,0x0059AA16,0x0059AA7F,0x0059AAB6,0x0059AAE1,0x0059AB3E,
0x0059ABB6,0x0059ABDA,0x0059AC51,0x0059ACA6,0x0059B23E,0x0059B267,0x0059B2A9,0x0059B2D9,0x0059B487,0x0059B4AF,
0x0059B992,0x0059BD1A,0x0059C0ED,0x0059C269,0x0059D555,0x0059D733,0x0059D7D6,0x0059F390,0x0059FA3F,0x0059FA7A,
0x005A03F7,0x005A0408,0x005A12E2,0x005A1930,0x005A5944,0x005A598B,0x005B28BB,0x005B2907,0x005B49D0,0x005B7432,
0x005BA217,0x005BAC2C,0x005BB802,0x005BE2D8,0x005BE354,0x005BE3F7,0x005BE49A,0x005BF87C,0x005BF89C,0x005BF8BC,
0x005BF8DC,0x005BF8F9,0x005BF974,0x005BF994,0x005BF9CC,0x005BFA0B,0x005BFA4A,0x005BFEAE,0x005BFF36,0x005BFF62,
0x005BFFC1,0x005C001D,0x005C08CA,0x005C2C5E,0x005C2E47,0x005C308D,0x005C76CB,0x005CBCD8,0x005CCB87,0x005CE90F,
0x005CF8D1,0x005D6C55,0x005D8E11,0x005D8F21,0x005DBC45,0x005DC66E,0x005DC687,0x005DE4AD,0x005DE4D4,0x005E0794,
0x005E0D9B,0x005E0E71,0x005E0EB9,0x005E183E,0x005E1877,0x005E23B6,0x005E2972,0x005E2BDE,0x005E3030,0x005E3482,
0x005E3ECF,0x005E3FA3,0x005E4B21,0x005E5BB4,0x005E69C3,0x005E8433,0x005E974C,0x005EA78E,0x005EA7BE,0x005EA7F1,
0x005EA821,0x005EA851,0x005EA876,0x005EA9C2,0x005EA9FF,0x005EAA4C,0x005EAAC8,0x005EB047,0x005EB07E,0x005EB19D,
0x005EB1D9,0x005EB212,0x005EB24B,0x005EB284,0x005EB2C0,0x005EB2F9,0x005EB332,0x005EB36E,0x005EB3A7,0x005EB3E2,
0x005EB41B,0x005EBB48,0x005EBC12,0x005EBC4B,0x005EBD15,0x005EBDDA,0x005EBE9F,0x005EBF91,0x005EC1D1,0x005EC229,
0x005EC262,0x005EC2B3,0x005EC5BE,0x005EC62D,0x005ECA1D,0x005ECC3A,0x005ECE06,0x005ECE9A,0x005ED104,0x005ED132,
0x005ED160,0x005ED18E,0x005ED1BC,0x005ED1EA,0x005ED218,0x005ED246,0x005ED274,0x005ED2A2,0x005ED2D0,0x005ED2FE,
0x005ED32C,0x005ED35A,0x005ED388,0x005ED43B,0x005ED465,0x005ED4BB,0x005ED5D2,0x005ED67D,0x005ED6B9,0x005ED720,
0x005ED73C,0x005ED999,0x005ED9D3,0x005EDA5E,0x005EDA8C,0x005EDB1F,0x005EDB67,0x005EDBA1,0x005EDBDF,0x005EDC04,
0x005F39A4,0x005F3A04,0x005F3A43,0x005F3A82,0x005F3ABE,0x005F3AFA,0x005F3F7C,0x005F43F6,0x00608E5F,0x006099C0,
0x006099EB,0x00609A8A,0x00609E9C,0x00609F71,0x0060A558,0x0060AC18,0x0060CEF7,0x0060D1F2,0x0060D206,0x0060E6A3,
0x0060F78F,0x0060F881,0x0060F8F1,0x0061054E,0x006105C1,0x00610B33,0x00610B4E,0x00610CE3,0x00613E65,0x00614CE4,
0x00614F2C,0x00615169,0x00615190,0x0061520A,0x006154BF,0x00615A4C,0x00615D8E,0x00615E06,0x00616E13,0x00616FF6,
0x00618198,0x006189A6,0x00619105,0x0061932D,0x0061DAF9,0x0061DC4E,0x0061DD99,0x0061DEF4,0x0061DF54,0x0061DFB1,
0x0061E131,0x0061E167,0x0061E1A4,0x0061E1DE,0x0061E531,0x0061E64A,0x0061E6B6,0x0061E796,0x0061E926,0x0061EAE7,
0x0061EC2D,0x0061EF55,0x0061F336,0x0061FC4F,0x0061FD54,0x0061FFF3,0x006200E4,0x0062078C,0x00620923,0x00620F93,
0x00621233,0x00621839,0x006218DD,0x00622452,0x00622461,0x0062280B,0x0062281A,0x00622C76,0x00622C85,0x00622D47,
0x00622D56,0x00623FAE,0x0062E3C5,0x0062F406,0x0062FE74,0x006316AC,0x006319FE,0x00631A7A,0x00631B14,0x00631B90,
0x00631C2A,0x00631CA6,0x00631E41,0x00631E64,0x00631E87,0x00632A00,0x00632CBA,0x00636BBE,0x006391CA,0x0063C5AD,
0x0063C5CF,0x0063C8B5,0x0063D16D,0x0063D19F,0x0063D205,0x0063D21D,0x0063D279,0x0063D2B9,0x006404E6,0x00640602,
0x00640656,0x00640677,0x00642BEE,0x006513D6,0x00658927,0x00658C06,0x00658C5D,0x0065AC8C,0x0065B65A,0x0065B887,
0x0065CBEB,0x0065CCB9,0x0065D190,0x0065D739,0x0065E31C,0x0065E793,0x0065E7F9,0x0065ED24,0x0065F841,0x0065F8A9,
0x006623B7,0x0066E175,0x0066F8B6,0x0066F906,0x00673676,0x006736F1,0x0067397E,0x006739F9,0x00673B24,0x00673B7C,
0x00673C12,0x006776E2,0x0067A096,0x0067A2A4,0x0067A4D6,0x0067EFE1,0x0068056E,0x00685477,0x00685747,0x00686AAF,
0x006874BB,0x00687784,0x0068B9E0,0x0069C5A4,0x006A72AC,0x006B4085,0x006B7607,0x006B76BE,0x006BB70C,0x006BC477,
0x006BC4A0,0x006BC4C9,0x006BC51E,0x006BC5D2,0x006BD0B8,0x006BE78B,0x006BE7A4,0x006BE7BD,0x006BEA98,0x006BEC11,
0x006BF6FC,0x006C0037,0x006C091B,0x006C0934,0x006C094D,0x006C0CA1,0x006C0EC3,0x006C1341,0x006C2C76,0x006C2D5A,
0x006C2E2C,0x006C2EF0,0x006C2F17,0x006C2F6F,0x006C3AF3,0x006D4242,0x006F0E89,0x006F3532,0x006F37A0,0x006F3A16,
0x006F3B69,0x006F3DF5,0x006F3F2C,0x006F3FB3,0x006F407F,0x006F40A3,0x006F40C4,0x006F40E4,0x006F4105,0x006F4138,
0x006F416C,0x006F41A5,0x006F41DD,0x006F4211,0x006F4245,0x006F427D,0x006F42B6,0x006F42EF,0x006F4327,0x006F43B9,
0x006F43EC,0x006F4420,0x006F4454,0x006F44A2,0x006F44D5,0x006F4538,0x006F464E,0x006F47BF,0x006F4850,0x006F49C1,
0x006F4A55,0x006F4B4E,0x006F4C49,0x006F4C7C,0x006F4CB0,0x006F4D7A,0x006F4D9B,0x006F4DBB,0x006F4DDC,0x006F4DFD,
0x006F4E1D,0x006F4E3B,0x006F4E59,0x006F4E76,0x006F4E94,0x006F52F8,0x006F63F8,0x006F6421,0x006F644A,0x006F6553,
0x006F667D,0x006F66D3,0x006F68E9,0x006F6939,0x006F6967,0x006F69EA,0x006F6A31,0x006F6BC3,0x006F6C3F,0x006F6CAA,
0x006F7166,0x006F7481,0x006F7575,0x006F834D,0x006F837F,0x006F83B0,0x006F8BC6,0x006F8BF9,0x006F8CBE,0x006F8CF1,
0x006F90F1,0x006F9159,0x006F91C1,0x006F922A,0x006F9256,0x006F9BC6,0x006F9CBA,0x006F9DAE,0x006F9EFC,0x00702871,
0x0070299D,0x00703C84,0x00703DB0,0x00704012,0x007040A0,0x007040BB,0x0070410B,0x007042AC,0x0070473D,0x00704B35,
0x00704F3E,0x00704F61,0x00705245,0x00705570,0x007056FE,0x00705D50,0x00706335,0x00706861,0x0070693E,0x00708F12,
0x00709987,0x0070F8E8,0x00712376,0x00715424,0x00715784,0x0071677B,0x007169E9,0x00716CC2,0x00721D91,0x00722953,
0x007229DD,0x00722A67,0x00722AA4,0x00722B65,0x00722CDB,0x0072318C,0x00723A25,0x00723C76,0x00723D92,0x00724EE9,
0x00725125,0x00725833,0x00727CD1,0x0072DA12,0x0072DA25,0x0072DA38,0x00772AB3,0x00772B93,0x00775549,0x007776EA,
0x00777731,0x00777800,0x00777957,0x007779A7,0x00777A94,0x00777ADE,0x00777B2D,0x007788BA,0x007789DD,0x00778A9B,
0x00779290,0x007792B8,0x0077F7E7,0x0077F815,0x0077F885,0x0077F8A7,0x0077F8EA,0x0077F90F,0x007A50F4,0x007A58E8,
0x007BD0F4,0x0081C175,0x0057602E,0x00576120,0x005763A0,0x0057653F,0x00576571,0x005765BF,0x005765F1,0x0057678A,
0x0057A9A0,0x0057A9C1,0x0057A9E2,0x0057AA03,0x0057AA21,0x0057AA3F,0x0057AA5D,0x0057AA7B,0x0057AABF,0x0057AAE0,
0x0057AB01,0x0057AB22,0x0057AB40,0x0057AB5E,0x0057AB7C,0x0057AB9A,0x0057ABDE,0x0057ABFF,0x0057AC20,0x0057AC41,
0x0057AC5F,0x0057AC7D,0x0057AC9B,0x0057ACB9,0x0057ACFD,0x0057AD1E,0x0057AD3F,0x0057AD60,0x0057AD7E,0x0057AD9C,
0x0057ADBA,0x0057ADD8,0x0057AE1C,0x0057AE3D,0x0057AE5E,0x0057AE7F,0x0057AE9D,0x0057AEBB,0x0057AED9,0x0057AEF7,
0x0057AF3B,0x0057AF5C,0x0057AF7A,0x0057AF98,0x0057AFB6,0x0057AFD4,0x0057B00B,0x0057B042,0x005A6448,0x005A6586,
0x005A6641,0x005A66F9,0x005A73A2,0x005A74BE,0x005AB9B7,0x005EC781,0x005EC7CD,0x0061E00C,0x0061E240,0x0064434B,
0x00648172,0x00649552,0x00649607,0x006F75AE,0x006F75DB,0x006F7608,0x006F7635,0x006F7662,0x006F768F,0x006F76BC,
0x006F76E9,0x006F7716,0x006F7743,0x006F7770,0x006F779D,0x006F77CA,0x006F77F7,0x006F7824,0x006F7851,0x006F787E,
0x006F78AB,0x006F78D8,0x006F7905,0x006F7932,0x006F8F77,0x006F9022,0x006F9054,0x00709584,0x0070C088,0x0070C7CC,
0x0070C848,0x00772BC4,0x00772BEF,0x00772C1C,0x00772C4C,0x00772C7A,0x00772CAA};


void IOnSend::Hook()
{
    Interface<ITools> Tools;

    for(size_t i=0; i < sizeof this->Patches / sizeof(unsigned long); i++)
        Tools->Intercept(ITools::_I_CALL, (void*)IOnSend::Patches[i], Hooks::KSocket::WritePacketAutoCrc, 5);
}